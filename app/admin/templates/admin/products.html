{% extends "base.html" %}
{% block title %}Produkty – Panel administracyjny{% endblock %}

{% block content %}
{% include "admin/_toolbar.html" %}

<div class="container my-4">

  <div class="d-flex justify-content-between align-items-center mb-3">
    <div>
      <h1 class="h3 mb-1">Produkty</h1>
      <p class="muted mb-0"> <!-- [ZMIANA] Użycie klasy .muted -->
        Zarządzaj ofertą sklepu, edytuj ceny, opisy i stany magazynowe.
      </p>
    </div>
    <div>
      <a href="{{ url_for('admin.new_product') }}" class="btn btn-primary btn-sm">
        <i class="bi bi-plus-circle me-1"></i> Dodaj nowy produkt
      </a>
    </div>
  </div>

  <!-- [ZMIANA] Usunięto .shadow-sm, style pochodzą z .admin-page .card -->
  <div class="card">
    <div class="card-body p-0">
      <!-- [ZMIANA] Style dla tabeli są teraz w style.css -->
      <table class="table table-hover mb-0 align-middle">
        <thead>
          <tr>
            <th style="width: 60px;">ID</th>
            <th>Nazwa</th>
            <th style="width: 130px;">Cena</th>
            <th style="width: 200px;">Kategoria</th>
            <th style="width: 100px;">Stan</th>
            <th style="width: 220px;" class="text-end">Akcje</th>
          </tr>
        </thead>
        <tbody>
          {% for p in products %}
          <tr>
            <td class="muted">{{ p.id }}</td> <!-- [ZMIANA] Użycie klasy .muted -->
            <td>
              <!-- [ZMIANA] Linki w tabeli powinny mieć jaśniejszy kolor -->
              <a href="{{ url_for('admin.product_detail', product_id=p.id) }}"
                 class="text-light text-decoration-none">
                {{ p.name }}
              </a>
            </td>
            <td>
              {% if p.price is not none %}
                {{ '%.2f'|format(p.price) }} zł
              {% else %}
                —
              {% endif %}
            </td>
            <td>
              {% if p.category %}
                {{ p.category.name }}
              {% else %}
                <span class="muted">brak</span>
              {% endif %}
            </td>
            <td>
              {% if p.stock is not none %}
                {{ p.stock }}
              {% else %}
                0
              {% endif %}
            </td>
            <td class="text-end">
              <a href="{{ url_for('admin.product_detail', product_id=p.id) }}"
                 class="btn btn-sm btn-outline-secondary me-1">
                Szczegóły
              </a>
              <a href="{{ url_for('admin.edit_product', product_id=p.id) }}"
                 class="btn btn-sm btn-outline-primary me-1">
                Edytuj
              </a>
              <form method="post"
                    action="{{ url_for('admin.delete_product', product_id=p.id) }}"
                    class="d-inline"
                    onsubmit="return confirm('Na pewno usunąć ten produkt?');">
                <button type="submit" class="btn btn-sm btn-outline-danger">
                  Usuń
                </button>
              </form>
            </td>
          </tr>
          {% else %}
          <tr>
            <td colspan="6" class="text-center py-4">
              Brak produktów w bazie. Dodaj pierwszy produkt, korzystając z przycisku
              <strong>„Dodaj nowy produkt”</strong>.
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>

</div>
{% endblock %}